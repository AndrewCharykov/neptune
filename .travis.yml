language: java
jdk: oraclejdk11

os: linux

env:
  - REPO_USER_NAME=qa REPO_USER_PASSWORD=qa123ws

before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/

# cache the build tool's caches
cache:
  directories:
    - $HOME/.m2
    - $HOME/.gradle

before_install: ignore

jobs:
  include:
  - stage: full_assembly
    install: skip
    before_script: echo "<STAGE 'full_assembly' is launching up...>"
    script: gradle assemble
    after_success: echo "<STAGE 'full_assembly' has been executed successfully>"
    after_failure: echo "<STAGE 'full_assembly' has been failed>"

  - stage: test_check
    install: skip
    before_script:
     - echo "<STAGE 'test_check' is launching up...>"
     - cd check
    script: gradle test
    after_success: echo "<STAGE 'test_check' has been executed successfully>"
    after_failure: echo "<STAGE 'test_check' has been failed>"

  - stage: test_http_api
    install: skip
    before_script:
    - echo "<STAGE 'test_http_api' is launching up...>"
    - cd http.api
    script: gradle test
    after_success: echo "<STAGE 'test_http_api' has been executed successfully>"
    after_failure: echo "<STAGE 'test_http_api' has been failed>"

#before_install: ignore
#before_script:
#  - echo "<General Build is launching up...>"
#  #- jdk_switcher use openjdk11
#
#install: true
#
#script:
#  - gradle assemble
#
#after_success:
#  - echo "Main Build has been executed successfully"
#  - bash <(curl -s https://codecov.io/bash)
#
#after_failure:
#  - echo "Houston, we have some problems"
#  - echo "Main Build has been failed"
